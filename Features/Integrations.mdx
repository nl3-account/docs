---
title: 'Integrations'
description: 'Identity Service Providers and Native languages'
---
## Identity Provider Integration
  Next Level3 Supports integrations to a variety of best in class identity providers as well as native support from most development languages. The following section outlines the steps required to setup and configure the integration for each of these providers. 

  For a better idea of how identity provider integrations are implemented and assistance with setting up AWS Cognito, watch the video below:

  <video
  controls
  className="w-full aspect-video"
  src="https://company.nextlevel3.com/videos/NL3AmazonCognitoIntegration.mp4"
  ></video>
  
  To get started first choose the identity provider your application uses and then follow the instructions to enable Next Level3 Cloud Identity JIT Access for that provider.

### Identity Provider Integration Instrcutions
  <AccordionGroup>
      <Accordion title="Auth0" href="/Tabs/auth0">
      </Accordion>
      <Accordion title="Microsoft Azure AD B2C" href="/Tabs/MAAD">
      </Accordion>
      <Accordion title="Microsoft Azure AD and O365" href="/Tabs/MAADO365">
      </Accordion>
      <Accordion title="AWS Cognito" href="/Tabs/AWSCog">
      </Accordion>
      <Accordion title="AWS IAM">
<img src="/images/aws cognito/cognito1.png" />
## AWS Cognito Integration
The Next Level3 AWS Cognito integration is designed to be used for your existing applications or sites that are using AWS Cognito for authentication. This integration will allow you to easily add Account Protection to any application that leverages AWS Cognito for authentication.

Pre-requisites
  * Application Authenticated via Amazon Cognito User Pools
  * Next Level3 Company Account
  * Signing Key created for an application in the Next Level3 Company Portal
### Account Protection
The first step to add an NL3 Account Protection Check to an existing application that uses Amazon Cognito User Pools for authentication is to create a Lambda function that performs the lock check. Here is some sample Python code:
```Python
import json
import os
import requests
import base64
import logging
from datetime import datetime
import jwt

def getLockStatus(token, api_uri, api_path, validationData):
  responseDict = {}
  try:
    headers_dict = {"x-nl3-authorization-token": token, "Content-Type": "application/json"}
    data_dict = {
      "userIP": validationData["ip"],
      "userDevice": validationData["device"],
      "userLocation": validationData["location"],
      "integrationType": "cognito",
      "integrationData": json.loads(validationData["additionalData"])
    }
    response = requests.post("".join([api_uri,api_path]), headers=headers_dict, json=data_dict)
    responseDict = response.json()
  except Exception as e:
    responseDict = { "message": str(e) }

  return responseDict

def lambda_handler(event, context):
  if event["callerContext"]["clientId"] == os.environ["CLIENT_ID"]:
    username = event["userName"]
    claims = {
      "iss": os.environ["APP_URI"],
      "iat": (datetime.utcnow().timestamp() + (-1 * 60)),
      "exp": (datetime.utcnow().timestamp() + (5 * 60)),
      "aud": os.environ["API_URI"],
      "sub": username
    }
    ### Ildeally the Signing Key would be stored and retrieved from a secrets manager
    ### and not an environmental variable
    decodedDomainToken = base64.b64decode(os.environ["SIGNING_KEY"])
    token = jwt.encode(
      payload=claims,
      key=decodedDomainToken
    )
    response = getLockStatus(token, os.environ["API_URI"], os.environ["API_PATH"], event["request"]["validationData"])
    if response.get("locked", False):
      raise Exception(os.environ["LOCKED_MESSAGE"])

    # Return to Amazon Cognito
    return event
```
The next step is to configure the Amazon Cognito User Pool to call this Lambda function as a “Pre authentication” trigger by clicking on the User Pool and then selecting “Triggers” under “General Settings” in the side menu. Then, you will select the function you created in the drop-down box under “Pre authenticaiton” as follows:
<img src="/images/aws cognito/cognito0.png" />
_*If you use IAM Roles and not IAM Users, please contact support to discuss the options for implementation and specific design considerations that may be required to implement this correctly using roles._

The next step is to setup the Amazon EventBridge event rule that triggers the Lambda function for specific events. Here is a sample rule:

References:

https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-get-started.html
      </Accordion>
  </AccordionGroup>

## Native Language Support
For more information about integrations and examples of implementing them please view the Native Language Support page:



## Step 4. Managing Access for your Company Portal Applications

Next, you will need to set up Next Level Cloud Identity JIT Access for the endpoints, users, and groups that are associated with your application(s).

<Card title="Users, Groups, and Enpoints" href="/Features/Users, Groups, and Endpoints">
  Endpoint, User, and Group Management
</Card>